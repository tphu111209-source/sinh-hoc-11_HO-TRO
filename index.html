<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sinh h·ªçc 11 - √în t·∫≠p nhanh</title>

  <style>
    :root{--bg:#f5f7fb;--card:#fff;--accent:#2563eb;--muted:#6b7280;--red-btn:#ef4444}
    *{box-sizing:border-box;font-family:Inter,system-ui,Roboto,Arial,sans-serif}
    body{margin:0;background:var(--bg);color:#111}
    header{background:linear-gradient(90deg,#0ea5e9,#2563eb);color:#fff;padding:14px 20px;
           display:flex;align-items:center;justify-content:space-between}
    header h1{margin:0;font-size:18px}
    nav a{color:#dbeafe;margin-left:12px;text-decoration:none;font-size:14px}
    .container{max-width:980px;margin:24px auto;padding:0 16px}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:16px}
    .card{background:var(--card);padding:16px;border-radius:8px;
          box-shadow:0 6px 18px rgba(16,24,40,0.06)}
    .small{font-size:14px;color:var(--muted)}
    .btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .mutebtn{background:#eee;color:#333;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    input{width:100%;padding:8px;margin-bottom:6px;border-radius:6px;border:1px solid #e6eef8}
    /* C·∫£i thi·ªán Lesson Item ƒë·ªÉ hi·ªÉn th·ªã t·ªët h∆°n */
    .lesson-item{border-left:4px solid #e6eef8;padding:8px;margin-bottom:12px;transition:all 0.1s; cursor:default;} 
    .lesson-item:hover{background:#f0f4f9;border-left:4px solid var(--accent);}
    .question{margin-bottom:8px}
    /* Th√™m style cho ti√™u ƒë·ªÅ ch∆∞∆°ng */
    .chapter-title{font-size:1.4em; color:#0e7490; margin-top:20px; margin-bottom:10px; padding-bottom:5px; border-bottom:1px solid #ccc;}
    
    /* --- STYLING CHO POP-UP MODAL M·ªöI --- */
    #modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6); /* N·ªÅn t·ªëi m·ªù */
        display: none; /* M·∫∑c ƒë·ªãnh ·∫©n */
        justify-content: center;
        align-items: center;
        z-index: 1000; /* Lu√¥n n·ªïi tr√™n m·ªçi th·ª© */
    }
    #modal-content {
        background-color: var(--card);
        padding: 24px;
        border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        width: 90%;
        max-width: 400px;
        text-align: center;
    }
    #modal-title {
        margin-top: 0;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
    }
    #modal-close-btn {
        margin-top: 15px;
        width: 100%;
        padding: 10px;
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    @media(max-width:860px){.grid{grid-template-columns:1fr}}
  </style>
</head>

<body>
<header>
  <h1>Sinh h·ªçc 11 ‚Äî √în t·∫≠p nhanh</h1>
  <nav>
    <a href="#lessons">T√≥m t·∫Øt</a>
    <a href="#quiz">√în t·∫≠p</a>
    <a href="#history">L·ªãch s·ª≠</a>
    <a href="#login" id="nav-user">ƒêƒÉng nh·∫≠p</a> 
  </nav>
</header>

<main class="container">
  <div class="grid">
    <section class="card" id="main-card"></section>

    <aside class="card">
      <h3 id="welcome" style="margin-top:0">B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p</h3>

      <div id="auth-controls">
        <input id="username" placeholder="T√™n h·ªçc sinh">
        <input id="password" placeholder="M·∫≠t kh·∫©u" type="password">

        <div style="display:flex; gap:8px; margin-top:8px">
          <button class="btn" id="btn-login">ƒêƒÉng nh·∫≠p</button>
          <button class="mutebtn" id="btn-register">ƒêƒÉng k√Ω</button>
        </div>
      </div>
      
      <button id="btn-logout" class="mutebtn" style="width:100%; margin-top:8px; display:none;">ƒêƒÉng xu·∫•t</button>

      <hr style="margin:14px 0">
      <p class="small">Ch·ªçn m·ª•c ·ªü b√™n tr√°i ƒë·ªÉ xem t√≥m t·∫Øt v√† l√†m b√†i.</p>
    </aside>
  </div>

  <footer style="text-align:center;margin-top:20px;color:#777;font-size:13px">
    ·ª®ng d·ª•ng l∆∞u d·ªØ li·ªáu tr√™n tr√¨nh duy·ªát (localStorage).
  </footer>
</main>

<div id="modal-overlay">
    <div id="modal-content">
        <h3 id="modal-title"></h3>
        <div id="modal-body"></div>
        <button id="modal-close-btn" onclick="hideModal()">ƒê√≥ng</button>
    </div>
</div>
<script>
// ---------------------- LOAD FILE JSON (G·ªôp 50 c√¢u h·ªèi & th√™m lesson ID) ----------------------
const QUIZ = [
  { "id": 1, "q": "Qu√° tr√¨nh v·∫≠n chuy·ªÉn n∆∞·ªõc t·ª´ r·ªÖ l√™n l√° ch·ªß y·∫øu theo con ƒë∆∞·ªùng n√†o?", "options": ["M·∫°ch r√¢y", "M·∫°ch g·ªó", "Qua gian b√†o"], "answer": 1, "lesson": "sh11_c1_b1" },
  { "id": 2, "q": "L·ª±c h√∫t do tho√°t h∆°i n∆∞·ªõc ·ªü l√° ƒë∆∞·ª£c g·ªçi l√†:", "options": ["√Åp su·∫•t r·ªÖ", "L·ª±c h√∫t l√°", "L·ª±c li√™n k·∫øt ‚Äì b√°m d√≠nh c·ªßa c·ªôt n∆∞·ªõc"], "answer": 1, "lesson": "sh11_c1_b1" },
  { "id": 3, "q": "R·ªÖ c√¢y h·∫•p th·ª• n∆∞·ªõc ch·ªß y·∫øu qua:", "options": ["Mi·ªÅn sinh tr∆∞·ªüng", "L√¥ng h√∫t", "V√≤ng t·∫°o g·ªó"], "answer": 1, "lesson": "sh11_c1_b1" },
  { "id": 4, "q": "C∆° quan quang h·ª£p ch·ªß y·∫øu c·ªßa th·ª±c v·∫≠t l√†:", "options": ["L√°", "Th√¢n", "R·ªÖ"], "answer": 0, "lesson": "sh11_c1_b2" },
  { "id": 5, "q": "S·∫£n ph·∫©m cu·ªëi c√πng c·ªßa quang h·ª£p ·ªü c√¢y C3 l√†:", "options": ["Tinh b·ªôt", "Saccarose", "Glucose"], "answer": 2, "lesson": "sh11_c1_b2" },
  { "id": 6, "q": "Enzyme Rubisco c√≥ ch·ª©c nƒÉng:", "options": ["Kh·ª≠ CO2", "C·ªë ƒë·ªãnh CO2", "V·∫≠n chuy·ªÉn e-"], "answer": 1, "lesson": "sh11_c1_b2" },
  { "id": 7, "q": "Con ƒë∆∞·ªùng kh√≠ kh·ªïng ƒë√≥ng m·ªü d·ª±a v√†o:", "options": ["√Åp su·∫•t th·∫©m th·∫•u", "Quang chu k√¨", "pH c·ªßa ƒë·∫•t"], "answer": 0, "lesson": "sh11_c1_b2" },
  { "id": 8, "q": "D√≤ng m·∫°ch r√¢y v·∫≠n chuy·ªÉn ch·ªß y·∫øu:", "options": ["N∆∞·ªõc v√† ion kho√°ng", "Ch·∫•t h·ªØu c∆°", "Oxi"], "answer": 1, "lesson": "sh11_c1_b1" },
  { "id": 9, "q": "Hormone k√≠ch th√≠ch sinh tr∆∞·ªüng ·ªü th·ª±c v·∫≠t l√†:", "options": ["Auxin", "Axit abxixic", "Etylen"], "answer": 0, "lesson": "sh11_c3_b1" },
  { "id": 10, "q": "Quang chu k·ª≥ ·∫£nh h∆∞·ªüng ch·ªß y·∫øu ƒë·∫øn:", "options": ["Quang h·ª£p", "S·ª± n·ªü hoa", "H√¥ h·∫•p"], "answer": 1, "lesson": "sh11_c3_b2" },
  { "id": 11, "q": "Pha s√°ng c·ªßa quang h·ª£p t·∫°o ra:", "options": ["CO2", "ATP v√† NADPH", "Tinh b·ªôt"], "answer": 1, "lesson": "sh11_c1_b2" },
  { "id": 12, "q": "H√¥ h·∫•p hi·∫øu kh√≠ x·∫£y ra ·ªü b√†o quan:", "options": ["L·ª•c l·∫°p", "Ti th·ªÉ", "M√†ng sinh ch·∫•t"], "answer": 1, "lesson": "sh11_c1_b3" },
  { "id": 13, "q": "S·∫£n ph·∫©m cu·ªëi c√πng c·ªßa h√¥ h·∫•p hi·∫øu kh√≠ l√†:", "options": ["H2O + CO2 + nƒÉng l∆∞·ª£ng", "C2H5OH + CO2", "Lactate"], "answer": 0, "lesson": "sh11_c1_b3" },
  { "id": 14, "q": "ƒê·ªëi v·ªõi ƒë·ªông v·∫≠t, h·ªá c∆° quan th·ª±c hi·ªán trao ƒë·ªïi kh√≠ l√†:", "options": ["H·ªá tu·∫ßn ho√†n", "H·ªá h√¥ h·∫•p", "H·ªá b√†i ti·∫øt"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 15, "q": "D·∫°ng v·∫≠n chuy·ªÉn O2 ch·ªß y·∫øu trong m√°u ng∆∞·ªùi:", "options": ["Oxi h√≤a tan", "Oxihemoglobin", "Oxi-enzym"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 16, "q": "CO2 ƒë∆∞·ª£c v·∫≠n chuy·ªÉn trong m√°u ch·ªß y·∫øu d∆∞·ªõi d·∫°ng:", "options": ["H√≤a tan", "CO2 li√™n k·∫øt hemoglobin", "Ion HCO3‚àí"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 17, "q": "ƒêi·ªán th·∫ø ngh·ªâ c·ªßa t·∫ø b√†o th·∫ßn kinh kho·∫£ng:", "options": ["-70 mV", "+70 mV", "0 mV"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 18, "q": "Synapse l√†:", "options": ["Khe gi·ªØa hai t·∫ø b√†o th·∫ßn kinh", "Th·ª• th·ªÉ", "S·ª£i tr·ª•c"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 19, "q": "Xung th·∫ßn kinh lan truy·ªÅn tr√™n s·ª£i tr·ª•c nh·ªù:", "options": ["Trao ƒë·ªïi ion qua m√†ng", "ƒê·ªôt bi·∫øn gen", "H√¨nh th√†nh ADN"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 20, "q": "Hormon insulin c√≥ vai tr√≤:", "options": ["TƒÉng ƒë∆∞·ªùng huy·∫øt", "Gi·∫£m ƒë∆∞·ªùng huy·∫øt", "TƒÉng nh·ªãp tim"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 21, "q": "Ti√™u h√≥a ·ªü d·∫° d√†y ch·ªß y·∫øu nh·ªù enzyme:", "options": ["Pepsin", "Tripsin", "Amylase"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 22, "q": "L·ªçc m√°u ·ªü th·∫≠n di·ªÖn ra t·∫°i:", "options": ["·ªêng g√≥p", "C·∫ßu th·∫≠n", "·ªêng l∆∞·ª£n xa"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 23, "q": "N∆∞·ªõc ti·ªÉu ƒë·∫ßu ch·ª©a nhi·ªÅu nh·∫•t:", "options": ["Protein", "T·∫ø b√†o m√°u", "N∆∞·ªõc v√† ion kho√°ng"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 24, "q": "Tim co b√≥p nh·ªù h·ªá d·∫´n truy·ªÅn:", "options": ["N∆°ron c·∫£m gi√°c", "N√∫t xoang ‚Äì n√∫t nhƒ© th·∫•t", "T·ªßy s·ªëng"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 25, "q": "Chu k√¨ tim g·ªìm:", "options": ["Pha nhƒ© co ‚Äì th·∫•t co ‚Äì d√£n chung", "Nhƒ© co ‚Äì gi√£n ‚Äì th·∫•t gi√£n", "Co ƒë·ªìng th·ªùi"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 26, "q": "H·ªá m·∫°ch c√≥ m√°u √°p su·∫•t cao nh·∫•t:", "options": ["Tƒ©nh m·∫°ch", "Mao m·∫°ch", "ƒê·ªông m·∫°ch"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 27, "q": "Mi·ªÖn d·ªãch kh√¥ng ƒë·∫∑c hi·ªáu g·ªìm:", "options": ["Kh√°ng th·ªÉ", "Lympho B", "H√†ng r√†o v·∫≠t l√≠ ‚Äì ƒë·∫°i th·ª±c b√†o"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 28, "q": "Mi·ªÖn d·ªãch thu ƒë∆∞·ª£c l√†:", "options": ["Sinh ra sau khi ph∆°i nhi·ªÖm", "C√≥ t·ª´ khi sinh ra", "Di truy·ªÅn"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 29, "q": "Ph·∫£n x·∫° c√≥ cung g·ªìm bao nhi√™u b·ªô ph·∫≠n?", "options": ["3", "4", "5"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 30, "q": "Hormon sinh tr∆∞·ªüng GH t√°c ƒë·ªông l√™n:", "options": ["X∆∞∆°ng v√† c∆°", "Tim", "Gan"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 31, "q": "Th·ª• tinh ·ªü th·ª±c v·∫≠t c√≥ hoa l√† s·ª± k·∫øt h·ª£p gi·ªØa:", "options": ["H·∫°t ph·∫•n + l√°", "Tinh t·ª≠ + no√£n", "H·∫°t ph·∫•n + v·ªè qu·∫£"], "answer": 1, "lesson": "sh11_c3_b2" },
  { "id": 32, "q": "C∆° ch·∫ø h∆∞·ªõng s√°ng c·ªßa th·ª±c v·∫≠t li√™n quan ƒë·∫øn:", "options": ["Auxin ph√¢n b·ªë kh√¥ng ƒë·ªÅu", "ABA tƒÉng l√™n", "Gibberellin tƒÉng m·∫°nh"], "answer": 0, "lesson": "sh11_c2_b1" },
  { "id": 33, "q": "H√¥ h·∫•p k·ªã kh√≠ t·∫°o ra:", "options": ["CO2 + n∆∞·ªõc", "R∆∞·ª£u etylic ho·∫∑c lactate", "Glucose"], "answer": 1, "lesson": "sh11_c1_b3" },
  { "id": 34, "q": "ƒê·ªông v·∫≠t h·∫±ng nhi·ªát c√≥ ƒë·∫∑c ƒëi·ªÉm:", "options": ["Th√¢n nhi·ªát thay ƒë·ªïi theo m√¥i tr∆∞·ªùng", "Th√¢n nhi·ªát ·ªïn ƒë·ªãnh", "Kh√¥ng ƒëi·ªÅu h√≤a th√¢n nhi·ªát"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 35, "q": "C√¥n tr√πng trao ƒë·ªïi kh√≠ qua:", "options": ["Ph·ªïi", "Mang", "H·ªá ·ªëng kh√≠"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 36, "q": "C·∫£m ·ª©ng ·ªü th·ª±c v·∫≠t ƒë·∫∑c tr∆∞ng b·ªüi:", "options": ["Ph·∫£n ·ª©ng nhanh", "Ph·∫£n ·ª©ng ch·∫≠m v√† kh√¥ng ƒë·ªãnh v·ªã", "Di chuy·ªÉn c√≥ h∆∞·ªõng"], "answer": 1, "lesson": "sh11_c2_b1" },
  { "id": 37, "q": "Th·ª• th·ªÉ √°nh s√°ng c·ªßa th·ª±c v·∫≠t l√†:", "options": ["Phytochrom", "Opsin", "Rhodopsin"], "answer": 0, "lesson": "sh11_c3_b2" },
  { "id": 38, "q": "B·ªô ph·∫≠n ki·ªÉm so√°t nh·ªãp h√¥ h·∫•p ·ªü ng∆∞·ªùi:", "options": ["Ti·ªÉu n√£o", "H√†nh n√£o", "V·ªè n√£o"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 39, "q": "Ti√™u h√≥a ·ªü ru·ªôt non ch·ªß y·∫øu nh·ªù:", "options": ["Enzyme d·ªãch v·ªã", "Men t·ª•y v√† d·ªãch m·∫≠t", "N∆∞·ªõc b·ªçt"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 40, "q": "M√°u ng∆∞·ªùi c√≥ m·∫•y lo·∫°i t·∫ø b√†o ch√≠nh?", "options": ["2", "3", "4"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 41, "q": "Tuy·∫øn gi√°p ti·∫øt ra:", "options": ["Adrenalin", "Thyroxin", "Insulin"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 42, "q": "Hormon ABA c√≥ t√°c d·ª•ng:", "options": ["K√≠ch th√≠ch n·∫£y m·∫ßm", "K√≠ch th√≠ch ra hoa", "G√¢y ng·ªß, ƒë√≥ng kh√≠ kh·ªïng"], "answer": 2, "lesson": "sh11_c3_b1" },
  { "id": 43, "q": "Th·ª±c v·∫≠t CAM ƒë·∫∑c tr∆∞ng b·ªüi:", "options": ["ƒê√≥ng kh√≠ kh·ªïng ban ng√†y", "ƒê√≥ng kh√≠ kh·ªïng ban ƒë√™m", "Kh√¥ng c√≥ kh√≠ kh·ªïng"], "answer": 1, "lesson": "sh11_c1_b2" },
  { "id": 44, "q": "M·ª° ƒë∆∞·ª£c ti√™u h√≥a nh·ªù enzyme:", "options": ["Lipase", "Protease", "Amylase"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 45, "q": "X∆∞∆°ng d√†i ph√°t tri·ªÉn chi·ªÅu d√†i nh·ªù:", "options": ["M√†ng x∆∞∆°ng", "S·ª•n tƒÉng tr∆∞·ªüng", "T·ªßy x∆∞∆°ng"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 46, "q": "S·ª± ph√°t tri·ªÉn ·ªü ƒë·ªông v·∫≠t kh√¥ng x∆∞∆°ng s·ªëng th∆∞·ªùng qua:", "options": ["Bi·∫øn th√°i", "ƒê·∫ª tr·ª©ng", "N·ªü hoa"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 47, "q": "Tinh tr√πng ƒë∆∞·ª£c s·∫£n xu·∫•t ·ªü:", "options": ["Th·∫≠n", "·ªêng sinh tinh", "·ªêng d·∫´n tinh"], "answer": 1, "lesson": "sh11_c_dv" },
  { "id": 48, "q": "No√£n ng∆∞·ªùi sau khi r·ª•ng t·ªìn t·∫°i kho·∫£ng:", "options": ["12‚Äì24 gi·ªù", "48 gi·ªù", "1 tu·∫ßn"], "answer": 0, "lesson": "sh11_c_dv" },
  { "id": 49, "q": "·ªêng Malpighi l√† c∆° quan b√†i ti·∫øt c·ªßa:", "options": ["C√°", "Chim", "C√¥n tr√πng"], "answer": 2, "lesson": "sh11_c_dv" },
  { "id": 50, "q": "H·ªá sinh d·ª•c n·ªØ ph√≥ng no√£n nh·ªù hormone:", "options": ["FSH", "LH", "TSH"], "answer": 1, "lesson": "sh11_c_dv" }
];


// ---------------------- LESSONS (Ho√†n thi·ªán t√≥m t·∫Øt & th√™m c·∫•u tr√∫c Ch∆∞∆°ng) ----------------------
const LESSONS = [
  { id: "sh11_c1_intro", chapter: "CH∆Ø∆†NG I: TRAO ƒê·ªîI CH·∫§T V√Ä NƒÇNG L∆Ø·ª¢NG ·ªû TH·ª∞C V·∫¨T", title: "T·ªïng quan", isChapter: true },
  {
    id:"sh11_c1_b1", chapter: "Ch∆∞∆°ng I", title:"B√†i 1: H·∫•p th·ª• & v·∫≠n chuy·ªÉn n∆∞·ªõc",
    summary:`R·ªÖ l√† c∆° quan h·∫•p th·ª• n∆∞·ªõc v√† ion kho√°ng ch·ªß y·∫øu. N∆∞·ªõc v√†o **l√¥ng h√∫t** b·∫±ng c∆° ch·∫ø **th·∫©m th·∫•u**, do ch√™nh l·ªách th·∫ø n∆∞·ªõc gi·ªØa ƒë·∫•t v√† t·∫ø b√†o. Ion kho√°ng ƒëi v√†o b·∫±ng **v·∫≠n chuy·ªÉn th·ª• ƒë·ªông** (theo graƒëien n·ªìng ƒë·ªô/ƒëi·ªán th·∫ø) ho·∫∑c **ch·ªß ƒë·ªông** (c·∫ßn ATP). N∆∞·ªõc di chuy·ªÉn t·ª´ l√¥ng h√∫t v√†o m·∫°ch g·ªó r·ªÖ theo hai con ƒë∆∞·ªùng ch√≠nh: **gian b√†o** (qua th√†nh t·∫ø b√†o) v√† **t·∫ø b√†o ch·∫•t** (xuy√™n m√†ng). Khi ƒë·∫øn **n·ªôi b√¨**, n∆∞·ªõc bu·ªôc ph·∫£i ƒëi qua ƒëai Caspari ƒë·ªÉ v√†o m·∫°ch g·ªó, gi√∫p ki·ªÉm so√°t d√≤ng n∆∞·ªõc v√† ch·∫•t tan. N∆∞·ªõc v·∫≠n chuy·ªÉn trong th√¢n (d√≤ng m·∫°ch g·ªó) nh·ªù ba l·ª±c: 1) **L·ª±c h√∫t do tho√°t h∆°i n∆∞·ªõc** ·ªü l√° (quan tr·ªçng nh·∫•t, t·∫°o √°p su·∫•t √¢m); 2) **L·ª±c li√™n k·∫øt ‚Äì b√°m d√≠nh** c·ªßa n∆∞·ªõc (gi·ªØ c·ªôt n∆∞·ªõc kh√¥ng ƒë·ª©t); 3) **L·ª±c ƒë·∫©y r·ªÖ** (do √°p su·∫•t th·∫©m th·∫•u). Tho√°t h∆°i n∆∞·ªõc ƒë√≥ng vai tr√≤ then ch·ªët trong vi·ªác t·∫°o d√≤ng m·∫°ch g·ªó v√† gi√∫p ƒëi·ªÅu h√≤a nhi·ªát ƒë·ªô cho c√¢y. Qu√° tr√¨nh v·∫≠n chuy·ªÉn ch·∫•t h·ªØu c∆° (s·∫£n ph·∫©m quang h·ª£p) di·ªÖn ra trong **m·∫°ch r√¢y** (d√≤ng m·∫°ch r√¢y) t·ª´ l√° xu·ªëng c√°c c∆° quan d·ª± tr·ªØ ho·∫∑c sinh tr∆∞·ªüng.`
  },
  {
    id:"sh11_c1_b2", chapter: "Ch∆∞∆°ng I", title:"B√†i 2: Quang h·ª£p",
    summary:`Quang h·ª£p l√† qu√° tr√¨nh s·ª≠ d·ª•ng nƒÉng l∆∞·ª£ng √°nh s√°ng ƒë·ªÉ t·ªïng h·ª£p ch·∫•t h·ªØu c∆° (ƒë∆∞·ªùng Glucose) t·ª´ CO‚ÇÇ v√† H‚ÇÇO, di·ªÖn ra ch·ªß y·∫øu ·ªü **l·ª•c l·∫°p** trong t·∫ø b√†o l√°. Qu√° tr√¨nh g·ªìm hai pha:
    * **Pha s√°ng** (t·∫°i m√†ng tilac√¥it): Bi·∫øn ƒë·ªïi nƒÉng l∆∞·ª£ng √°nh s√°ng th√†nh nƒÉng l∆∞·ª£ng h√≥a h·ªçc, t·∫°o ra **ATP**, **NADPH** v√† gi·∫£i ph√≥ng **O‚ÇÇ** t·ª´ qu√° tr√¨nh quang ph√¢n ly n∆∞·ªõc. C√°c s·∫Øc t·ªë (Di·ªáp l·ª•c a, b, Car√¥ten√¥it) h·∫•p th·ª• √°nh s√°ng.
    * **Pha t·ªëi** (t·∫°i ch·∫•t n·ªÅn l·ª•c l·∫°p): S·ª≠ d·ª•ng ATP v√† NADPH t·ª´ pha s√°ng ƒë·ªÉ **c·ªë ƒë·ªãnh CO‚ÇÇ** t·∫°o ƒë∆∞·ªùng th√¥ng qua **chu tr√¨nh Calvin** (C‚ÇÉ). Enzyme **Rubisco** l√† enzyme quan tr·ªçng nh·∫•t c·ªë ƒë·ªãnh CO‚ÇÇ.
    Th·ª±c v·∫≠t ƒë∆∞·ª£c ph√¢n lo·∫°i th√†nh C‚ÇÉ, C‚ÇÑ v√† CAM. **C‚ÇÑ** v√† **CAM** c√≥ c∆° ch·∫ø c·ªë ƒë·ªãnh CO‚ÇÇ s∆° b·ªô (t·∫°o axit 4-carbon) ƒë·ªÉ th√≠ch nghi v·ªõi m√¥i tr∆∞·ªùng kh√¥ n√≥ng, gi·∫£m **h√¥ h·∫•p s√°ng** v√† t·ªëi ∆∞u kh·∫£ nƒÉng h·∫•p th·ª• CO‚ÇÇ. C∆∞·ªùng ƒë·ªô quang h·ª£p b·ªã chi ph·ªëi b·ªüi **√°nh s√°ng** (c∆∞·ªùng ƒë·ªô, th√†nh ph·∫ßn), **CO‚ÇÇ**, **n∆∞·ªõc**, **nhi·ªát ƒë·ªô** v√† h√†m l∆∞·ª£ng **di·ªáp l·ª•c**. Quang h·ª£p cung c·∫•p O‚ÇÇ v√† ch·∫•t h·ªØu c∆° cho s·ª± s·ªëng, quy·∫øt ƒë·ªãnh nƒÉng su·∫•t n√¥ng nghi·ªáp.`
  },
  {
    id:"sh11_c1_b3", chapter: "Ch∆∞∆°ng I", title:"B√†i 3: H√¥ h·∫•p ·ªü th·ª±c v·∫≠t",
    summary:`H√¥ h·∫•p l√† qu√° tr√¨nh **oxy h√≥a** c√°c ch·∫•t h·ªØu c∆° (nh∆∞ Glucose) th√†nh CO‚ÇÇ v√† H‚ÇÇO, gi·∫£i ph√≥ng nƒÉng l∆∞·ª£ng (ch·ªß y·∫øu l√† **ATP**) ƒë·ªÉ cung c·∫•p cho m·ªçi ho·∫°t ƒë·ªông s·ªëng c·ªßa c√¢y. H√¥ h·∫•p g·ªìm ba giai ƒëo·∫°n ch√≠nh: 1) **ƒê∆∞·ªùng ph√¢n** (t·∫ø b√†o ch·∫•t, t·∫°o 2 ATP v√† 2 Pyruvate); 2) **Chu tr√¨nh Crebs** (ti th·ªÉ, t·∫°o ra CO‚ÇÇ v√† H‚Å∫); 3) **Chu·ªói chuy·ªÅn electron** (m√†ng trong ti th·ªÉ, t·∫°o ra ph·∫ßn l·ªõn ATP nh·ªù O‚ÇÇ l√† ch·∫•t nh·∫≠n electron cu·ªëi c√πng). **H√¥ h·∫•p hi·∫øu kh√≠** (c√≥ O‚ÇÇ) t·∫°o ra kho·∫£ng 30-32 ATP. **H√¥ h·∫•p k·ªã kh√≠** (kh√¥ng O‚ÇÇ) x·∫£y ra trong ƒëi·ªÅu ki·ªán thi·∫øu oxy, t·∫°o ra r∆∞·ª£u etylic ho·∫∑c axit lactic v√† ch·ªâ 2 ATP, g√¢y ƒë·ªôc cho c√¢y. NƒÉng l∆∞·ª£ng h√¥ h·∫•p ƒë∆∞·ª£c d√πng cho: sinh tr∆∞·ªüng, h·∫•p th·ª• ion kho√°ng ch·ªß ƒë·ªông, t·ªïng h·ª£p c√°c ch·∫•t m·ªõi (protein, lipid, axit nucleic) v√† duy tr√¨ s·ª©c tr∆∞∆°ng. C∆∞·ªùng ƒë·ªô h√¥ h·∫•p b·ªã ·∫£nh h∆∞·ªüng m·∫°nh b·ªüi **nhi·ªát ƒë·ªô** (tƒÉng theo nhi·ªát ƒë·ªô ƒë·∫øn gi·ªõi h·∫°n t·ªëi ∆∞u), **n∆∞·ªõc**, **oxy** v√† tr·∫°ng th√°i sinh l√Ω c·ªßa c√¢y.`
  },

  { id: "sh11_c2_intro", chapter: "CH∆Ø∆†NG II: C·∫¢M ·ª®NG ·ªû TH·ª∞C V·∫¨T", title: "T·ªïng quan", isChapter: true },
  {
    id:"sh11_c2_b1", chapter: "Ch∆∞∆°ng II", title:"B√†i 4: H∆∞·ªõng ƒë·ªông",
    summary:`**H∆∞·ªõng ƒë·ªông** (Tropism) l√† h√¨nh th·ª©c c·∫£m ·ª©ng c·ªßa th·ª±c v·∫≠t b·∫±ng c√°ch sinh tr∆∞·ªüng theo h∆∞·ªõng c·ªßa k√≠ch th√≠ch t·ª´ m√¥i tr∆∞·ªùng. Ph·∫£n ·ª©ng n√†y l√† **sinh tr∆∞·ªüng c√≥ h∆∞·ªõng**. C√°c d·∫°ng ch√≠nh g·ªìm: **h∆∞·ªõng s√°ng** (th√¢n d∆∞∆°ng, r·ªÖ √¢m), **h∆∞·ªõng tr·ªçng l·ª±c** (r·ªÖ d∆∞∆°ng, th√¢n √¢m), **h∆∞·ªõng n∆∞·ªõc** (r·ªÖ d∆∞∆°ng), **h∆∞·ªõng h√≥a** (r·ªÖ v·ªÅ ph√≠a ch·∫•t dinh d∆∞·ª°ng), v√† **h∆∞·ªõng ti·∫øp x√∫c** (th√¢n leo qu·∫•n v√†o gi√° th·ªÉ). C∆° ch·∫ø chung l√† s·ª± ph√¢n b·ªë **kh√¥ng ƒë·ªÅu c·ªßa Auxin**: Auxin ph√¢n b·ªë nhi·ªÅu h∆°n ·ªü ph√≠a kh√¥ng b·ªã k√≠ch th√≠ch (ho·∫∑c b·ªã k√≠ch th√≠ch y·∫øu h∆°n) l√†m ph√≠a ƒë√≥ sinh tr∆∞·ªüng nhanh h∆°n, g√¢y ra s·ª± u·ªën cong. V√≠ d·ª•, trong h∆∞·ªõng s√°ng, auxin d·ªìn v·ªÅ ph√≠a t·ªëi, k√≠ch th√≠ch k√©o d√†i t·∫ø b√†o ph√≠a t·ªëi nhanh h∆°n ph√≠a s√°ng, l√†m ng·ªçn c√¢y cong v·ªÅ ph√≠a s√°ng. H∆∞·ªõng ƒë·ªông l√† c∆° ch·∫ø quan tr·ªçng gi√∫p c√¢y c·ªë ƒë·ªãnh v√† th√≠ch nghi, t·ªëi ∆∞u h√≥a vi·ªác h·∫•p th·ª• √°nh s√°ng v√† ch·∫•t dinh d∆∞·ª°ng.`
  },
  {
    id:"sh11_c2_b2", chapter: "Ch∆∞∆°ng II", title:"B√†i 5: ·ª®ng ƒë·ªông",
    summary:`**·ª®ng ƒë·ªông** (Nastic movement) l√† ph·∫£n ·ª©ng c·ªßa th·ª±c v·∫≠t ƒë√°p l·∫°i k√≠ch th√≠ch nh∆∞ng **kh√¥ng ph·ª• thu·ªôc v√†o h∆∞·ªõng** c·ªßa k√≠ch th√≠ch. ·ª®ng ƒë·ªông th∆∞·ªùng l√† ph·∫£n ·ª©ng nhanh h∆°n h∆∞·ªõng ƒë·ªông. C√≥ hai lo·∫°i ch√≠nh:
    * **·ª®ng ƒë·ªông sinh tr∆∞·ªüng**: Li√™n quan ƒë·∫øn t·ªëc ƒë·ªô sinh tr∆∞·ªüng kh√¥ng ƒë·ªÅu c·ªßa c√°c ph·∫ßn c∆° quan (v√≠ d·ª•: c√°nh hoa m·ªü ra/kh√©p l·∫°i, n·ªü c·ªßa hoa m∆∞·ªùi gi·ªù theo √°nh s√°ng). C∆° ch·∫ø ch·ªß y·∫øu do s·ª± thay ƒë·ªïi n·ªìng ƒë·ªô Auxin, Gibberellin ho·∫∑c do **Quang chu k√¨** (Phytochrom) chi ph·ªëi s·ª± sinh tr∆∞·ªüng c·ªßa c√°c m·∫∑t c√°nh hoa.
    * **·ª®ng ƒë·ªông kh√¥ng sinh tr∆∞·ªüng**: Do s·ª± thay ƒë·ªïi ƒë·ªôt ng·ªôt v·ªÅ **s·ª©c tr∆∞∆°ng n∆∞·ªõc** c·ªßa c√°c nh√≥m t·∫ø b√†o (v√≠ d·ª•: l√° trinh n·ªØ c·ª•p l·∫°i khi ch·∫°m v√†o ‚Äì ·ª©ng ƒë·ªông ti·∫øp x√∫c, ho·∫∑c s·ª± b·∫Øt m·ªìi c·ªßa c√¢y n·∫Øp ·∫•m). Khi k√≠ch th√≠ch x·∫£y ra, s·ª± di chuy·ªÉn ion v√† n∆∞·ªõc nhanh ch√≥ng l√†m thay ƒë·ªïi s·ª©c tr∆∞∆°ng ·ªü c√°c t·∫ø b√†o ƒë·ªám (pulvinus), g√¢y ra s·ª± v·∫≠n ƒë·ªông.
    ·ª®ng ƒë·ªông gi√∫p c√¢y ph·∫£n ·ª©ng linh ho·∫°t, th√≠ch nghi v·ªõi s·ª± thay ƒë·ªïi c·ªßa m√¥i tr∆∞·ªùng (√°nh s√°ng, nhi·ªát ƒë·ªô) v√† th·ª±c hi·ªán ch·ª©c nƒÉng t·ª± b·∫£o v·ªá.`
  },

  { id: "sh11_c3_intro", chapter: "CH∆Ø∆†NG III: SINH TR∆Ø·ªûNG V√Ä PH√ÅT TRI·ªÇN ·ªû TH·ª∞C V·∫¨T", title: "T·ªïng quan", isChapter: true },
  {
    id:"sh11_c3_b1", chapter: "Ch∆∞∆°ng III", title:"B√†i 6: Sinh tr∆∞·ªüng & Hoocm√¥n th·ª±c v·∫≠t",
    summary:`**Sinh tr∆∞·ªüng** l√† s·ª± tƒÉng kh√¥ng th·ªÉ ƒë·∫£o ng∆∞·ª£c v·ªÅ k√≠ch th∆∞·ªõc v√† kh·ªëi l∆∞·ª£ng c·ªßa th·ª±c v·∫≠t do tƒÉng s·ªë l∆∞·ª£ng v√† k√≠ch th∆∞·ªõc t·∫ø b√†o.
    * **Sinh tr∆∞·ªüng s∆° c·∫•p** (tƒÉng chi·ªÅu d√†i) di·ªÖn ra ·ªü ƒë·ªânh r·ªÖ, ƒë·ªânh th√¢n do m√¥ ph√¢n sinh ƒë·ªânh.
    * **Sinh tr∆∞·ªüng th·ª© c·∫•p** (tƒÉng chi·ªÅu ngang) di·ªÖn ra ·ªü th√¢n, r·ªÖ c√¢y th√¢n g·ªó do m√¥ ph√¢n sinh b√™n (t·∫ßng sinh m·∫°ch).
    C√°c **hoocm√¥n th·ª±c v·∫≠t** (Phytohormone) ƒëi·ªÅu h√≤a qu√° tr√¨nh n√†y: **Auxin** (k√≠ch th√≠ch k√©o d√†i t·∫ø b√†o, h√¨nh th√†nh r·ªÖ, g√¢y h∆∞·ªõng ƒë·ªông); **Gibberellin** (k√≠ch th√≠ch k√©o d√†i th√¢n, n·∫£y m·∫ßm, ra hoa s·ªõm); **Xitokinin** (k√≠ch th√≠ch ph√¢n chia t·∫ø b√†o, l√†m ch·∫≠m l√£o h√≥a); **Axit Abxixic (ABA)** (g√¢y tr·∫°ng th√°i ng·ªß, ƒë√≥ng kh√≠ kh·ªïng, ·ª©c ch·∫ø n·∫£y m·∫ßm); **Ethylen** (k√≠ch th√≠ch qu·∫£ ch√≠n, r·ª•ng l√°). S·ª± c√¢n b·∫±ng gi·ªØa c√°c hormone k√≠ch th√≠ch v√† ·ª©c ch·∫ø quy·∫øt ƒë·ªãnh t·ªëc ƒë·ªô v√† h√¨nh th√°i sinh tr∆∞·ªüng c·ªßa c√¢y. Sinh tr∆∞·ªüng b·ªã chi ph·ªëi b·ªüi c√°c y·∫øu t·ªë ngo√†i nh∆∞ di truy·ªÅn, √°nh s√°ng, n∆∞·ªõc, nhi·ªát ƒë·ªô v√† dinh d∆∞·ª°ng kho√°ng.`
  },
  {
    id:"sh11_c3_b2", chapter: "Ch∆∞∆°ng III", title:"B√†i 7: Ph√°t tri·ªÉn ·ªü th·ª±c v·∫≠t",
    summary:`**Ph√°t tri·ªÉn** ·ªü th·ª±c v·∫≠t l√† to√†n b·ªô qu√° tr√¨nh s·ªëng, bao g·ªìm s·ª± sinh tr∆∞·ªüng, s·ª± ph√¢n h√≥a v√† h√¨nh th√†nh c√°c c∆° quan m·ªõi (nh∆∞ ra hoa, t·∫°o qu·∫£). Ph√°t tri·ªÉn l√† m·ªôt qu√° tr√¨nh chu k·ª≥ v√† kh√¥ng th·ªÉ ƒë·∫£o ng∆∞·ª£c. Qu√° tr√¨nh n√†y ƒë∆∞·ª£c ƒëi·ªÅu h√≤a b·ªüi s·ª± ph·ªëi h·ª£p gi·ªØa c√°c hoocm√¥n v√† c√°c y·∫øu t·ªë m√¥i tr∆∞·ªùng.
    * **Quang chu k√¨** (t∆∞∆°ng quan gi·ªØa ƒë·ªô d√†i ng√†y v√† ƒë√™m) l√† y·∫øu t·ªë quy·∫øt ƒë·ªãnh s·ª± ra hoa. Th·ª±c v·∫≠t ƒë∆∞·ª£c chia th√†nh: **Ng√†y d√†i** (c·∫ßn ƒë√™m ng·∫Øn), **Ng√†y ng·∫Øn** (c·∫ßn ƒë√™m d√†i) v√† **Trung t√≠nh**. S·ª± c·∫£m nh·∫≠n quang chu k√¨ di·ªÖn ra ·ªü l√° nh·ªù s·∫Øc t·ªë **Phytochrom** (thay ƒë·ªïi gi·ªØa d·∫°ng Pƒë v√† Px).
    * **Xu√¢n h√≥a** l√† s·ª± c·∫£m ·ª©ng ra hoa nh·ªù nhi·ªát ƒë·ªô th·∫•p.
    * **Hoocm√¥n th·ª±c v·∫≠t** ƒë√≥ng vai tr√≤ ƒëi·ªÅu h√≤a to√†n b·ªô qu√° tr√¨nh ph√°t tri·ªÉn (v√≠ d·ª•: Florigen ƒë∆∞·ª£c cho l√† ch·∫•t k√≠ch th√≠ch ra hoa, di chuy·ªÉn t·ª´ l√° l√™n ch·ªìi).
    * **Th·ª• tinh** ·ªü th·ª±c v·∫≠t l√† s·ª± k·∫øt h·ª£p gi·ªØa tinh t·ª≠ v√† no√£n. Sau th·ª• tinh, b·∫ßu nh·ª•y ph√°t tri·ªÉn th√†nh qu·∫£, no√£n ph√°t tri·ªÉn th√†nh h·∫°t.
    Hi·ªÉu bi·∫øt v·ªÅ ph√°t tri·ªÉn gi√∫p con ng∆∞·ªùi ƒëi·ªÅu khi·ªÉn s·ª± ra hoa, tƒÉng nƒÉng su·∫•t c√¢y tr·ªìng (v√≠ d·ª•: d√πng Gibberellin ƒë·ªÉ tƒÉng k√≠ch th∆∞·ªõc qu·∫£ kh√¥ng h·∫°t).`
  }
  // Th√™m m·ª•c √¥n t·∫≠p ƒê·ªông v·∫≠t (n·∫øu c·∫ßn l·ªçc ri√™ng)
  , { id: "sh11_c_dv", chapter: "√îN T·∫¨P TH√äM", title: "Trao ƒë·ªïi ch·∫•t v√† C·∫£m ·ª©ng ·ªü ƒê·ªông v·∫≠t", summary: "T√≥m t·∫Øt chung c√°c n·ªôi dung ƒë·ªông v·∫≠t (H√¥ h·∫•p, Tu·∫ßn ho√†n, Th·∫ßn kinh, Ti·∫øt, N·ªôi ti·∫øt) ƒë·ªÉ ki·ªÉm tra th√™m.", isChapter: false }
];

// ---------------------- POP-UP MODAL LOGIC M·ªöI ----------------------
/**
 * Hi·ªÉn th·ªã pop-up (modal) v·ªõi n·ªôi dung t√πy ch·ªânh.
 * @param {string} title Ti√™u ƒë·ªÅ c·ªßa pop-up (v√≠ d·ª•: "Th√†nh c√¥ng", "L·ªói")
 * @param {string} message N·ªôi dung th√¥ng b√°o
 */
function showModal(title, message) {
  document.getElementById("modal-title").textContent = title;
  document.getElementById("modal-body").innerHTML = `<p>${message}</p>`;
  document.getElementById("modal-overlay").style.display = "flex"; // Hi·ªÉn th·ªã modal
}

/**
 * ·∫®n pop-up (modal).
 */
function hideModal() {
  document.getElementById("modal-overlay").style.display = "none";
}

// Th√™m s·ª± ki·ªán click ƒë·ªÉ ƒë√≥ng modal khi click v√†o n·ªÅn t·ªëi
document.getElementById("modal-overlay").addEventListener('click', function(event) {
    // Ch·ªâ ƒë√≥ng modal n·∫øu click tr·ª±c ti·∫øp v√†o l·ªõp overlay (kh√¥ng ph·∫£i n·ªôi dung modal)
    if (event.target.id === 'modal-overlay') {
        hideModal();
    }
});
// -------------------------------------------------------------------


// ---------------------- AUTH LOGIC ----------------------
function currentUser(){ return localStorage.getItem("edu_user"); }

// C·∫≠p nh·∫≠t giao di·ªán b√™n l·ªÅ (Side Panel)
function updateUserPanel(){
  const u = currentUser();
  const welcome = document.getElementById("welcome");
  const controls = document.getElementById("auth-controls");
  const logout = document.getElementById("btn-logout");

  if(u){
    welcome.textContent = "Xin ch√†o, " + u;
    controls.style.display = "none";
    logout.style.display = "block"; // Hi·ªÉn th·ªã n√∫t ƒêƒÉng xu·∫•t
    document.getElementById("nav-user").textContent = u;
  } else {
    welcome.textContent = "B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p";
    controls.style.display = "flex"; // Hi·ªÉn th·ªã kh·ªëi ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω
    logout.style.display = "none";
    document.getElementById("nav-user").textContent = "ƒêƒÉng nh·∫≠p";
  }
}

// X·ª≠ l√Ω ƒêƒÉng k√Ω (ƒê√£ thay th·∫ø alert() b·∫±ng showModal())
document.getElementById("btn-register").onclick = ()=>{
  const username = document.getElementById("username");
  const password = document.getElementById("password");
  const user = username.value.trim();
  const pass = password.value.trim();
  if(!user || !pass) return showModal("L·ªói", "Vui l√≤ng nh·∫≠p ƒë·ªß T√™n v√† M·∫≠t kh·∫©u!");

  let accounts = JSON.parse(localStorage.getItem("edu_accounts") || "{}");
  if(accounts[user]) return showModal("L·ªói", "T√™n ƒëƒÉng nh·∫≠p ƒë√£ t·ªìn t·∫°i. Vui l√≤ng ch·ªçn t√™n kh√°c!");

  accounts[user] = pass;
  localStorage.setItem("edu_accounts", JSON.stringify(accounts));
  showModal("Th√†nh c√¥ng", "ƒêƒÉng k√Ω th√†nh c√¥ng! Gi·ªù b·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p.");
  username.value = ""; // X√≥a d·ªØ li·ªáu c≈©
  password.value = "";
};

// X·ª≠ l√Ω ƒêƒÉng nh·∫≠p (ƒê√£ thay th·∫ø alert() b·∫±ng showModal())
document.getElementById("btn-login").onclick = ()=>{
  const user = document.getElementById("username").value.trim();
  const pass = document.getElementById("password").value.trim();

  let acc = JSON.parse(localStorage.getItem("edu_accounts") || "{}");
  if(!acc[user] || acc[user] !== pass) return showModal("L·ªói", "Sai t√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u. Ho·∫∑c b·∫°n ch∆∞a ƒëƒÉng k√Ω!");

  localStorage.setItem("edu_user", user);
  updateUserPanel();
  showModal("ƒêƒÉng nh·∫≠p th√†nh c√¥ng", "Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i! H√£y b·∫Øt ƒë·∫ßu √¥n t·∫≠p.");
  navigateTo("home"); 
};

// X·ª≠ l√Ω ƒêƒÉng xu·∫•t
document.getElementById("btn-logout").onclick = ()=>{
  localStorage.removeItem("edu_user");
  updateUserPanel();
  showModal("Th√¥ng b√°o", "B·∫°n ƒë√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng.");
  navigateTo("home"); 
};

// ---------------------- HISTORY ----------------------
function saveAttempt(at){
  let arr = JSON.parse(localStorage.getItem("quiz_history") || "[]");
  arr.push(at);
  localStorage.setItem("quiz_history", JSON.stringify(arr));
}
function loadHistory(){
  return JSON.parse(localStorage.getItem("quiz_history") || "[]");
}

// ---------------------- RENDER PAGES ----------------------
const mainCard = document.getElementById("main-card");

function renderHome(){
  mainCard.innerHTML = `
    <h2>Trang ch·ªß</h2>
    <p class="small">Ch·ªçn ch·∫ø ƒë·ªô √¥n t·∫≠p ho·∫∑c ƒë·ªçc t√≥m t·∫Øt b√†i h·ªçc.</p>
    <button class="btn" onclick="navigateTo('quiz')">B·∫Øt ƒë·∫ßu √¥n t·∫≠p</button>
  `;
}

// H√†m renderLessons (ƒê√£ th√™m n√∫t Quay l·∫°i Trang ch·ªß)
function renderLessons() {
  let html = `
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2>T√≥m t·∫Øt b√†i h·ªçc Sinh h·ªçc 11</h2>
        <button class="mutebtn" onclick="navigateTo('home')">Quay l·∫°i Trang ch·ªß</button>
    </div>
    <hr style="margin-top:0">
  `;
  let currentChapter = "";

  LESSONS.forEach(l => {
    if (l.isChapter) {
      html += `<h3 class="chapter-title">üìö ${l.chapter}</h3>`;
      currentChapter = l.chapter.split(":")[0]; // Ch·ªâ l·∫•y "CH∆Ø∆†NG X"
    } else {
      html += `
        <div class="lesson-item">
          <strong>${l.title}</strong>
          <p class="small" style="margin-top:2px; margin-bottom:4px; color:#555;"><i>${currentChapter}</i></p>
          <p class="small">${l.summary}</p>
        </div>`;
    }
  });

  mainCard.innerHTML = html;
}

// --------- QUIZ MODE (T·∫°o giao di·ªán t√°ch ch·∫ø ƒë·ªô) ---------
function renderQuiz(){
  mainCard.innerHTML = `
    <h2>Ch·ªçn ch·∫ø ƒë·ªô √¥n t·∫≠p</h2>
    <p class="small" style="margin-bottom:15px;">B·∫°n c√≥ th·ªÉ √¥n t·∫≠p to√†n b·ªô 50 c√¢u h·ªèi ƒë√£ t·ªïng h·ª£p ho·∫∑c l√†m b√†i ki·ªÉm tra t·∫≠p trung theo t·ª´ng b√†i h·ªçc.</p>
    <button class="btn" onclick="loadQuiz(QUIZ, '√în to√†n b·ªô 50 c√¢u')">√în t·∫≠p to√†n b·ªô</button>
    <button class="mutebtn" style="margin-left:8px" onclick="startQuiz('lesson')">Ki·ªÉm tra theo b√†i</button>
  `;
}

// H√†m startQuiz (Th√™m n√∫t Quay l·∫°i Trang ch·ªß khi ch·ªçn b√†i ki·ªÉm tra)
function startQuiz(mode){
  if(mode === "lesson"){
    let html = `
      <div style="display:flex; justify-content:space-between; align-items:center;">
          <h2>Ch·ªçn b√†i ki·ªÉm tra</h2>
          <button class="mutebtn" onclick="navigateTo('home')">Quay l·∫°i Trang ch·ªß</button>
      </div>
      <hr style="margin-top:0">
    `;
    let currentChapter = "";

    LESSONS.forEach(l=>{
      if (l.isChapter) {
        html += `<h3 class="chapter-title">üìù ${l.chapter}</h3>`;
        currentChapter = l.chapter;
      } else {
        const quizCount = QUIZ.filter(q => q.lesson === l.id).length;
        if (quizCount > 0) {
            html += `<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px">
                        <span style="font-weight:500; flex-grow:1;">${l.title}</span>
                        <button class="mutebtn" onclick="loadLessonQuiz('${l.id}')">
                          L√†m b√†i (${quizCount} c√¢u)
                        </button>
                      </div>`;
        }
      }
    });

    mainCard.innerHTML = html;
    return;
  }
}

function loadLessonQuiz(id){
  const list = QUIZ.filter(q => q.lesson === id);
  if(list.length===0){
    mainCard.innerHTML = "<p>Ch∆∞a c√≥ c√¢u h·ªèi cho b√†i n√†y.</p>";
    return;
  }
  const lessonInfo = LESSONS.find(l => l.id === id);
  const title = lessonInfo ? lessonInfo.title : "B√†i ki·ªÉm tra";
  loadQuiz(list, title);
}

function loadQuiz(list, quizTitle = "√în t·∫≠p"){
  let idx = 0, score = 0;
  function show(){
    const q = list[idx];
    let html = `<h2>${quizTitle}</h2>
                <p style="font-size:1.1em; color:var(--accent); margin-bottom:10px;">C√¢u ${idx+1}/${list.length}</p>
                <p class="question"><strong>${q.q}</strong></p>`;
    q.options.forEach((opt,i)=>{
      // Th√™m hi·ªÉn th·ªã s·ªë th·ª© t·ª± option
      html += `<button class="mutebtn" style="display:block;width:100%;text-align:left;margin-bottom:6px"
                onclick="answer(${i})">${i+1}. ${opt}</button>`;
    });
    html += `<div id="fb" style="margin-top:14px; min-height:30px;"></div>`;
    mainCard.innerHTML = html;
  }

  window.answer = function(i){
    // V√¥ hi·ªáu h√≥a c√°c n√∫t sau khi tr·∫£ l·ªùi
    mainCard.querySelectorAll('.mutebtn').forEach(btn => btn.disabled = true);

    const correct = (i === list[idx].answer);
    document.getElementById("fb").innerHTML =
      correct ? `<span style='color:green; font-weight:bold;'>‚úÖ Ch√≠nh x√°c!</span>`
              : `<span style='color:red; font-weight:bold;'>‚ùå Sai. ƒê√°p √°n ƒë√∫ng: ${list[idx].options[list[idx].answer]}</span>`;

    // ƒê√°nh d·∫•u ƒë√°p √°n ƒë√£ ch·ªçn v√† ƒë√°p √°n ƒë√∫ng
    const buttons = mainCard.querySelectorAll('.mutebtn');
    buttons[i].style.backgroundColor = correct ? '#dcfce7' : '#fee2e2'; // Xanh l√°/ƒê·ªè cho ƒë√°p √°n ƒë√£ ch·ªçn
    if (!correct) {
      buttons[list[idx].answer].style.backgroundColor = '#dcfce7'; // ƒê√°nh d·∫•u ƒë√°p √°n ƒë√∫ng
    }

    if(correct) score++;
    idx++;

    // T·ª± ƒë·ªông chuy·ªÉn c√¢u ho·∫∑c k·∫øt th√∫c
    if(idx < list.length)
      setTimeout(show, 1500); // ƒê·ª£i 1.5s tr∆∞·ªõc khi chuy·ªÉn c√¢u
    else{
      document.getElementById("fb").innerHTML +=
        `<div style='margin-top:16px; padding:10px; border-top:1px dashed #ccc;'>
          <strong style="font-size:1.2em;">üéâ K·∫øt th√∫c b√†i ${quizTitle}: ${score}/${list.length}</strong>
          <p>
            <button class="btn" style="margin-top:10px;" onclick="navigateTo('quiz')">L√†m b√†i kh√°c</button>
            <button class="mutebtn" style="margin-top:10px; margin-left:8px;" onclick="navigateTo('home')">Quay l·∫°i Trang ch·ªß</button>
          </p>
        </div>`;
      saveAttempt({user: currentUser(), quiz: quizTitle, score, total:list.length, date:Date.now()});
    }
  }

  show();
}

function renderHistory(){
  const arr = loadHistory();
  let html = `
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2>L·ªãch s·ª≠ l√†m b√†i</h2>
        <button class="mutebtn" onclick="navigateTo('home')">Quay l·∫°i Trang ch·ªß</button>
    </div>
    <hr style="margin-top:0">
  `;
  if(!arr.length) html += "<p class='small'>Ch∆∞a c√≥ d·ªØ li·ªáu.</p>";
  else{
    html += "<table style='width:100%; border-collapse:collapse; margin-top:10px;'>";
    html += "<tr><th style='border:1px solid #eee; padding:8px; text-align:left;'>Ng√†y</th><th style='border:1px solid #eee; padding:8px; text-align:left;'>H·ªçc sinh</th><th style='border:1px solid #eee; padding:8px; text-align:left;'>B√†i ki·ªÉm tra</th><th style='border:1px solid #eee; padding:8px; text-align:left;'>ƒêi·ªÉm</th></tr>";
    arr.reverse().forEach(a=>{
      html += `<tr>
        <td style='border:1px solid #eee; padding:8px;'>${new Date(a.date).toLocaleString()}</td>
        <td style='border:1px solid #eee; padding:8px;'>${a.user}</td>
        <td style='border:1px solid #eee; padding:8px;'>${a.quiz || 'To√†n b·ªô'}</td>
        <td style='border:1px solid #eee; padding:8px; font-weight:bold;'>${a.score}/${a.total}</td>
      </tr>`;
    });
    html += "</table>";
  }
  mainCard.innerHTML = html;
}

// ---------------------- NAVIGATION ----------------------
function navigateTo(page){
  location.hash = page;
  route();
}
function route(){
  const h = location.hash.replace("#","") || "home";
  if(h==="home") renderHome();
  else if(h==="lessons") renderLessons();
  else if(h==="quiz") renderQuiz();
  else if(h==="history") renderHistory();
  else renderHome();
}

updateUserPanel();
window.onhashchange = route; 
route();
</script>

</body>
</html>